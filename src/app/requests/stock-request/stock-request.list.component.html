<div class="p-3 container">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3>Stock Requests</h3>
    <div *ngIf="isStockroom()">
      <button class="btn btn-sm btn-success" (click)="create()">New Request</button>
    </div>
  </div>

  <table class="table table-sm">
    <thead>
      <tr>
        <th>ID</th>
        <th>Room</th>
        <th>Requester</th>
        <th>Item Type</th>
        <th>Qty</th>
        <th>Date</th>
        <th>Status</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let r of requests">
        <td>{{ r.stockRequestId || r.id }}</td>
        <td>{{ r.requesterRoomId }}</td>
        <td>{{ r.acccountId || r.accountId }}</td>
        <td>{{ r.itemType }}</td>
        <td>{{ r.quantity }}</td>
        <td>{{ r.createdAt || r.created_at || r.updatedAt }}</td>
        <td>{{ r.status }}</td>
        <td>
          <button class="btn btn-sm btn-outline-primary" (click)="view(r)">View</button>

          <button *ngIf="isAdmin() && r.status === 'pending'" class="btn btn-sm btn-success ms-1" (click)="approve(r)">Approve</button>
          <button *ngIf="isAdmin() && r.status === 'pending'" class="btn btn-sm btn-warning ms-1" (click)="disapprove(r)">Disapprove</button>

          <button *ngIf="isStockroom() && r.status === 'approved'" class="btn btn-sm btn-danger ms-1" (click)="fulfill(r)">Fulfill</button>
        </td>
      </tr>
    </tbody>
  </table>

  <div *ngIf="loading" class="text-center">
    <span class="spinner-border spinner-border-sm"></span>
  </div>
</div>