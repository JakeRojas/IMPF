<div class="release-list-wrapper mt-2">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h5 class="fw-bold mb-0 text-dark">
      <i class="bi bi-box-arrow-right text-danger me-2"></i>Released Apparel Batches
    </h5>
  </div>

  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-danger border-3" role="status"></div>
    <p class="text-muted mt-2 small fw-bold">Loading release history...</p>
  </div>

  <div class="card border-0 shadow-sm overflow-hidden" *ngIf="!loading && batches?.length">
    <div class="table-responsive">
      <table class="table table-hover align-middle mb-0">
        <thead class="bg-light">
          <tr>
            <th class="px-4 py-3">Batch ID</th>
            <th class="py-3">Apparel Item</th>
            <th class="py-3 text-center">Qty</th>
            <th class="py-3">Claimed By</th>
            <th class="py-3">Released By</th>
            <th class="py-3">Date</th>
            <th class="py-3 px-4">Remarks</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let b of batches">
            <td class="px-4">
              <span class="badge bg-danger-subtle text-danger fw-bold">#{{ b.releaseApparelId }}</span>
            </td>
            <td>
              <div class="fw-bold text-dark">{{ b.ApparelInventory?.apparelName || 'Item #' + b.apparelInventoryId }}
              </div>
              <div class="extra-small text-muted" *ngIf="b.ApparelInventory">
                {{ b.ApparelInventory.apparelLevel }} • {{ b.ApparelInventory.apparelType }} • {{
                b.ApparelInventory.apparelSize }}
              </div>
            </td>
            <td class="text-center">
              <span class="fw-bold fs-5 text-danger">{{ b.releaseApparelQuantity }}</span>
            </td>
            <td>
              <div class="small fw-semibold text-dark">{{ b.claimedBy || '—' }}</div>
            </td>
            <td>
              <div class="d-flex align-items-center">
                <div
                  class="avatar-sm bg-light text-muted rounded-circle me-2 d-flex align-items-center justify-content-center"
                  style="width: 24px; height: 24px;">
                  <i class="bi bi-person-check small"></i>
                </div>
                <span class="small">{{ b.Account ? (b.Account.firstName + ' ' + b.Account.lastName) : (b.releasedBy ||
                  'System') }}</span>
              </div>
            </td>
            <td class="small text-muted">
              {{ (b.createdAt || b.releasedAt) | date:'mediumDate' }}
              <div class="extra-small">{{ (b.createdAt || b.releasedAt) | date:'shortTime' }}</div>
            </td>
            <td class="px-4 small text-muted italic">
              {{ b.remarks || b.notes || '—' }}
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="text-center py-5 bg-white rounded-4 shadow-sm" *ngIf="!loading && (!batches || batches.length === 0)">
    <i class="bi bi-box-arrow-right text-muted opacity-25" style="font-size: 4rem;"></i>
    <h5 class="mt-3 fw-bold text-dark">No Release Records</h5>
    <p class="text-muted small">No apparel batches have been released from this room yet.</p>
  </div>

  <!-- Quick inventory view (kept per your request) -->
  <div *ngIf="inventory?.length" class="mt-5">
    <div class="d-flex align-items-center mb-3">
      <div class="vr me-2 text-primary" style="width: 4px; height: 20px; opacity: 1; border-radius: 2px;"></div>
      <h6 class="fw-bold mb-0">Current Room Inventory (Quick View)</h6>
    </div>
    <div class="card border-0 shadow-sm overflow-hidden">
      <div class="table-responsive">
        <table class="table table-sm table-hover align-middle mb-0">
          <thead class="bg-light extra-small text-uppercase letter-spacing-1">
            <tr>
              <th class="px-3 py-2">Item</th>
              <th class="py-2">Level</th>
              <th class="py-2">Type</th>
              <th class="py-2">Size</th>
              <th class="py-2 text-center">In Stock</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let it of inventory">
              <td class="px-3 small fw-bold">{{ it.apparelName }}</td>
              <td class="small text-muted">{{ it.apparelLevel }}</td>
              <td class="small text-muted">{{ it.apparelType }}</td>
              <td class="small text-muted">{{ it.apparelSize }}</td>
              <td class="text-center">
                <span class="badge rounded-pill"
                  [ngClass]="(it.totalQuantity ?? it.quantity ?? 0) > 0 ? 'bg-success-subtle text-success' : 'bg-danger-subtle text-danger'">
                  {{ it.totalQuantity ?? it.quantity ?? 0 }}
                </span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<style>
  .extra-small {
    font-size: 0.7rem;
  }

  .italic {
    font-style: italic;
  }

  .letter-spacing-1 {
    letter-spacing: 0.5px;
  }
</style>